(function(a){a.jCookies=function(t){t=a.extend({},a.jCookies.defaults,t);if(t.get||t.erase){for(var n={},r="",q=[],s=document.cookie.split(";"),m=0;m<s.length;m++){for(var l=s[m];" "==l.charAt(0);){l=l.substring(1,l.length)}r=l.split("=")[0];if(0==r.length){break}n[r]=l.substring(r.length+1,l.length);q[q.length]=r}if(t.erase){s=new Date;s.setTime(s.getTime()+-86400000);if("*"==t.erase){for(r in n){document.cookie=r+"=erase; expires="+s.toGMTString()+"; path=/"}return !0}for(r in q){if(q[r]==t.erase){return document.cookie=t.erase+"=erase; expires="+s.toGMTString()+"; path=/",!0}}return !1}if(t.get){if("*"==t.get&&n){for(r in n){try{n[r]=JSON.parse(atob(n[r]))}catch(j){try{n[r]=JSON.parse(atob(decodeURIComponent(n[r])))}catch(g){if(t.error){return g}}if(t.error){return j}}}return n}for(x in q){if(q[x]==t.get){try{return JSON.parse(atob(n[t.get]))}catch(c){if(t.error){return c}}}}return !1}}else{return t.name&&(t.value||t.days)?(s=new Date,isNaN(t.seconds)?isNaN(t.minutes)?isNaN(t.hours)?s.setTime(s.getTime()+86400000*t.days):s.setTime(s.getTime()+3600000*t.hours):s.setTime(s.getTime()+60000*t.minutes):s.setTime(s.getTime()+1000*t.seconds),document.cookie=t.name+"="+btoa(JSON.stringify(t.value))+"; expires="+s.toGMTString()+"; path=/",!0):!1}};a.jCookies.defaults={name:"",value:"",days:27}})(jQuery);if("undefined"==typeof btoa){var btoa=function(p){for(var j=[],m=0;m<p.length;){var o=p.charCodeAt(m++),n=p.charCodeAt(m++),g=p.charCodeAt(m++),l=(o<<16)+((n||0)<<8)+(g||0),o=(l&16515072)>>18,k=(l&258048)>>12,n=isNaN(n)?64:(l&4032)>>6,g=isNaN(g)?64:l&63;j[j.length]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(o);j[j.length]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(k);j[j.length]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n);j[j.length]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)}return j.join("")}}if("undefined"==typeof atob){var atob=function(n){var i=0!=n.length%4,k=/[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=]/.test(n),m=/=/.test(n)&&(/=[^=]/.test(n)||/={3}/.test(n));if(i||k||m){throw Error("Invalid base64 data")}i=[];for(k=0;k<n.length;){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n.charAt(k++)),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n.charAt(k++)),j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n.charAt(k++)),m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n.charAt(k++)),l=(l<<18)+(g<<12)+((j&63)<<6)+(m&63),j=64==j?-1:(l&65280)>>8,m=64==m?-1:l&255;i[i.length]=String.fromCharCode((l&16711680)>>16);0<=j&&(i[i.length]=String.fromCharCode(j));0<=m&&(i[i.length]=String.fromCharCode(m))}return i.join("")}}this.JSON||(this.JSON={});(function(){function c(a){return a<10?"0"+a:a}function a(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=i[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function f(d,c){var e,l,m,i,n=b,j,g=c[d];g&&(typeof g==="object"&&typeof g.toJSON==="function")&&(g=g.toJSON(d));typeof k==="function"&&(g=k.call(c,d,g));switch(typeof g){case"string":return a(g);case"number":return isFinite(g)?""+g:"null";case"boolean":case"null":return""+g;case"object":if(!g){return"null"}b=b+h;j=[];if(Object.prototype.toString.apply(g)==="[object Array]"){i=g.length;for(e=0;e<i;e=e+1){j[e]=f(e,g)||"null"}m=j.length===0?"[]":b?"[\n"+b+j.join(",\n"+b)+"\n"+n+"]":"["+j.join(",")+"]";b=n;return m}if(k&&typeof k==="object"){i=k.length;for(e=0;e<i;e=e+1){l=k[e];if(typeof l==="string"){(m=f(l,g))&&j.push(a(l)+(b?": ":":")+m)}}}else{for(l in g){if(Object.hasOwnProperty.call(g,l)){(m=f(l,g))&&j.push(a(l)+(b?": ":":")+m)}}}m=j.length===0?"{}":b?"{\n"+b+j.join(",\n"+b)+"\n"+n+"}":"{"+j.join(",")+"}";b=n;return m}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+c(this.getUTCMonth()+1)+"-"+c(this.getUTCDate())+"T"+c(this.getUTCHours())+":"+c(this.getUTCMinutes())+":"+c(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b,h,i={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;if(typeof JSON.stringify!=="function"){JSON.stringify=function(a,d,e){var c;h=b="";if(typeof e==="number"){for(c=0;c<e;c=c+1){h=h+" "}}else{typeof e==="string"&&(h=e)}if((k=d)&&typeof d!=="function"&&(typeof d!=="object"||typeof d.length!=="number")){throw Error("JSON.stringify")}return f("",{"":a})}}if(typeof JSON.parse!=="function"){JSON.parse=function(a,b){function e(a,d){var c,f,g=a[d];if(g&&typeof g==="object"){for(c in g){if(Object.hasOwnProperty.call(g,c)){f=e(g,c);f!==void 0?g[c]=f:delete g[c]}}}return b.call(a,d,g)}var c,a=""+a;d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){c=eval("("+a+")");return typeof b==="function"?e({"":c},""):c}throw new SyntaxError("JSON.parse")}}})();(function(){function Z(b,n,m){if(b===n){return b!==0||1/b==1/n}if(b==null||n==null){return b===n}if(b._chain){b=b._wrapped}if(n._chain){n=n._wrapped}if(b.isEqual&&aj.isFunction(b.isEqual)){return b.isEqual(n)}if(n.isEqual&&aj.isFunction(n.isEqual)){return n.isEqual(b)}var l=af.call(b);if(l!=af.call(n)){return false}switch(l){case"[object String]":return b==String(n);case"[object Number]":return b!=+b?n!=+n:b==0?1/b==1/n:b==+n;case"[object Date]":case"[object Boolean]":return +b==+n;case"[object RegExp]":return b.source==n.source&&b.global==n.global&&b.multiline==n.multiline&&b.ignoreCase==n.ignoreCase}if(typeof b!="object"||typeof n!="object"){return false}for(var k=m.length;k--;){if(m[k]==b){return true}}m.push(b);var k=0,j=true;if(l=="[object Array]"){if(k=b.length,j=k==n.length){for(;k--;){if(!(j=k in b==k in n&&Z(b[k],n[k],m))){break}}}}else{if("constructor" in b!="constructor" in n||b.constructor!=n.constructor){return false}for(var i in b){if(aj.has(b,i)&&(k++,!(j=aj.has(n,i)&&Z(b[i],n[i],m)))){break}}if(j){for(i in n){if(aj.has(n,i)&&!k--){break}}j=!k}}m.pop();return j}var X=this,P=X._,ad={},ag=Array.prototype,ac=Object.prototype,ai=ag.slice,M=ag.unshift,af=ac.toString,g=ac.hasOwnProperty,N=ag.forEach,h=ag.map,f=ag.reduce,d=ag.reduceRight,ab=ag.filter,Y=ag.every,W=ag.some,aa=ag.indexOf,V=ag.lastIndexOf,ac=Array.isArray,e=Object.keys,U=Function.prototype.bind,aj=function(b){return new ae(b)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=aj}exports._=aj}else{X._=aj}aj.VERSION="1.3.1";var ah=aj.each=aj.forEach=function(b,l,k){if(b!=null){if(N&&b.forEach===N){b.forEach(l,k)}else{if(b.length===+b.length){for(var j=0,i=b.length;j<i;j++){if(j in b&&l.call(k,b[j],j,b)===ad){break}}}else{for(j in b){if(aj.has(b,j)&&l.call(k,b[j],j,b)===ad){break}}}}}};aj.map=aj.collect=function(j,l,i){var k=[];if(j==null){return k}if(h&&j.map===h){return j.map(l,i)}ah(j,function(b,n,m){k[k.length]=l.call(i,b,n,m)});if(j.length===+j.length){k.length=j.length}return k};aj.reduce=aj.foldl=aj.inject=function(b,l,k,j){var i=arguments.length>2;b==null&&(b=[]);if(f&&b.reduce===f){return j&&(l=aj.bind(l,j)),i?b.reduce(l,k):b.reduce(l)}ah(b,function(n,m,o){i?k=l.call(j,k,n,m,o):(k=n,i=true)});if(!i){throw new TypeError("Reduce of empty array with no initial value")}return k};aj.reduceRight=aj.foldr=function(b,m,l,k){var j=arguments.length>2;b==null&&(b=[]);if(d&&b.reduceRight===d){return k&&(m=aj.bind(m,k)),j?b.reduceRight(m,l):b.reduceRight(m)}var i=aj.toArray(b).reverse();k&&!j&&(m=aj.bind(m,k));return j?aj.reduce(i,m,l,k):aj.reduce(i,m)};aj.find=aj.detect=function(j,l,i){var k;T(j,function(b,n,m){if(l.call(i,b,n,m)){return k=b,true}});return k};aj.filter=aj.select=function(j,l,i){var k=[];if(j==null){return k}if(ab&&j.filter===ab){return j.filter(l,i)}ah(j,function(b,n,m){l.call(i,b,n,m)&&(k[k.length]=b)});return k};aj.reject=function(j,l,i){var k=[];if(j==null){return k}ah(j,function(b,n,m){l.call(i,b,n,m)||(k[k.length]=b)});return k};aj.every=aj.all=function(j,l,i){var k=true;if(j==null){return k}if(Y&&j.every===Y){return j.every(l,i)}ah(j,function(b,n,m){if(!(k=k&&l.call(i,b,n,m))){return ad}});return k};var T=aj.some=aj.any=function(b,k,j){k||(k=aj.identity);var i=false;if(b==null){return i}if(W&&b.some===W){return b.some(k,j)}ah(b,function(m,l,n){if(i||(i=k.call(j,m,l,n))){return ad}});return !!i};aj.include=aj.contains=function(j,k){var i=false;if(j==null){return i}return aa&&j.indexOf===aa?j.indexOf(k)!=-1:i=T(j,function(b){return b===k})};aj.invoke=function(b,j){var i=ai.call(arguments,2);return aj.map(b,function(k){return(aj.isFunction(j)?j||k:k[j]).apply(k,i)})};aj.pluck=function(b,i){return aj.map(b,function(j){return j[i]})};aj.max=function(b,k,j){if(!k&&aj.isArray(b)){return Math.max.apply(Math,b)}if(!k&&aj.isEmpty(b)){return -Infinity}var i={computed:-Infinity};ah(b,function(m,l,n){l=k?k.call(j,m,l,n):m;l>=i.computed&&(i={value:m,computed:l})});return i.value};aj.min=function(b,k,j){if(!k&&aj.isArray(b)){return Math.min.apply(Math,b)}if(!k&&aj.isEmpty(b)){return Infinity}var i={computed:Infinity};ah(b,function(m,l,n){l=k?k.call(j,m,l,n):m;l<i.computed&&(i={value:m,computed:l})});return i.value};aj.shuffle=function(j){var i=[],k;ah(j,function(b,l){l==0?i[0]=b:(k=Math.floor(Math.random()*(l+1)),i[l]=i[k],i[k]=b)});return i};aj.sortBy=function(b,j,i){return aj.pluck(aj.map(b,function(l,k,m){return{value:l,criteria:j.call(i,l,k,m)}}).sort(function(l,k){var n=l.criteria,m=k.criteria;return n<m?-1:n>m?1:0}),"value")};aj.groupBy=function(b,k){var j={},i=aj.isFunction(k)?k:function(l){return l[k]};ah(b,function(m,l){var n=i(m,l);(j[n]||(j[n]=[])).push(m)});return j};aj.sortedIndex=function(b,m,l){l||(l=aj.identity);for(var k=0,j=b.length;k<j;){var i=k+j>>1;l(b[i])<l(m)?k=i+1:j=i}return k};aj.toArray=function(b){return !b?[]:b.toArray?b.toArray():aj.isArray(b)?ai.call(b):aj.isArguments(b)?ai.call(b):aj.values(b)};aj.size=function(b){return aj.toArray(b).length};aj.first=aj.head=function(j,i,k){return i!=null&&!k?ai.call(j,0,i):j[0]};aj.initial=function(j,i,k){return ai.call(j,0,j.length-(i==null||k?1:i))};aj.last=function(j,i,k){return i!=null&&!k?ai.call(j,Math.max(j.length-i,0)):j[j.length-1]};aj.rest=aj.tail=function(j,i,k){return ai.call(j,i==null||k?1:i)};aj.compact=function(b){return aj.filter(b,function(i){return !!i})};aj.flatten=function(b,i){return aj.reduce(b,function(j,k){if(aj.isArray(k)){return j.concat(i?k:aj.flatten(k))}j[j.length]=k;return j},[])};aj.without=function(b){return aj.difference(b,ai.call(arguments,1))};aj.uniq=aj.unique=function(b,k,j){var j=j?aj.map(b,j):b,i=[];aj.reduce(j,function(n,m,l){if(0==l||(k===true?aj.last(n)!=m:!aj.include(n,m))){n[n.length]=m,i[i.length]=b[l]}return n},[]);return i};aj.union=function(){return aj.uniq(aj.flatten(arguments,true))};aj.intersection=aj.intersect=function(b){var i=ai.call(arguments,1);return aj.filter(aj.uniq(b),function(j){return aj.every(i,function(k){return aj.indexOf(k,j)>=0})})};aj.difference=function(b){var i=aj.flatten(ai.call(arguments,1));return aj.filter(b,function(j){return !aj.include(i,j)})};aj.zip=function(){for(var b=ai.call(arguments),k=aj.max(aj.pluck(b,"length")),j=Array(k),i=0;i<k;i++){j[i]=aj.pluck(b,""+i)}return j};aj.indexOf=function(b,k,j){if(b==null){return -1}var i;if(j){return j=aj.sortedIndex(b,k),b[j]===k?j:-1}if(aa&&b.indexOf===aa){return b.indexOf(k)}for(j=0,i=b.length;j<i;j++){if(j in b&&b[j]===k){return j}}return -1};aj.lastIndexOf=function(j,i){if(j==null){return -1}if(V&&j.lastIndexOf===V){return j.lastIndexOf(i)}for(var k=j.length;k--;){if(k in j&&j[k]===i){return k}}return -1};aj.range=function(j,i,n){arguments.length<=1&&(i=j||0,j=0);for(var n=arguments[2]||1,m=Math.max(Math.ceil((i-j)/n),0),l=0,k=Array(m);l<m;){k[l++]=j,j+=n}return k};var R=function(){};aj.bind=function(b,k){var j,i;if(b.bind===U&&U){return U.apply(b,ai.call(arguments,1))}if(!aj.isFunction(b)){throw new TypeError}i=ai.call(arguments,2);return j=function(){if(!(this instanceof j)){return b.apply(k,i.concat(ai.call(arguments)))}R.prototype=b.prototype;var l=new R,m=b.apply(l,i.concat(ai.call(arguments)));return Object(m)===m?m:l}};aj.bindAll=function(b){var i=ai.call(arguments,1);i.length==0&&(i=aj.functions(b));ah(i,function(j){b[j]=aj.bind(b[j],b)});return b};aj.memoize=function(b,j){var i={};j||(j=aj.identity);return function(){var k=j.apply(this,arguments);return aj.has(i,k)?i[k]:i[k]=b.apply(this,arguments)}};aj.delay=function(j,i){var k=ai.call(arguments,2);return setTimeout(function(){return j.apply(j,k)},i)};aj.defer=function(b){return aj.delay.apply(aj,[b,1].concat(ai.call(arguments,1)))};aj.throttle=function(b,p){var o,n,m,l,k,j=aj.debounce(function(){k=l=false},p);return function(){o=this;n=arguments;var i;m||(m=setTimeout(function(){m=null;k&&b.apply(o,n);j()},p));l?k=true:b.apply(o,n);j();l=true}};aj.debounce=function(j,i){var k;return function(){var l=this,b=arguments;clearTimeout(k);k=setTimeout(function(){k=null;j.apply(l,b)},i)}};aj.once=function(j){var i=false,k;return function(){if(i){return k}i=true;return k=j.apply(this,arguments)}};aj.wrap=function(j,i){return function(){var b=[j].concat(ai.call(arguments,0));return i.apply(this,b)}};aj.compose=function(){var b=arguments;return function(){for(var i=arguments,j=b.length-1;j>=0;j--){i=[b[j].apply(this,i)]}return i[0]}};aj.after=function(j,i){return j<=0?i():function(){if(--j<1){return i.apply(this,arguments)}}};aj.keys=e||function(b){if(b!==Object(b)){throw new TypeError("Invalid object")}var j=[],i;for(i in b){aj.has(b,i)&&(j[j.length]=i)}return j};aj.values=function(b){return aj.map(b,aj.identity)};aj.functions=aj.methods=function(b){var j=[],i;for(i in b){aj.isFunction(b[i])&&j.push(i)}return j.sort()};aj.extend=function(b){ah(ai.call(arguments,1),function(i){for(var j in i){b[j]=i[j]}});return b};aj.defaults=function(b){ah(ai.call(arguments,1),function(i){for(var j in i){b[j]==null&&(b[j]=i[j])}});return b};aj.clone=function(b){return !aj.isObject(b)?b:aj.isArray(b)?b.slice():aj.extend({},b)};aj.tap=function(j,i){i(j);return j};aj.isEqual=function(j,i){return Z(j,i,[])};aj.isEmpty=function(b){if(aj.isArray(b)||aj.isString(b)){return b.length===0}for(var i in b){if(aj.has(b,i)){return false}}return true};aj.isElement=function(b){return !!(b&&b.nodeType==1)};aj.isArray=ac||function(b){return af.call(b)=="[object Array]"};aj.isObject=function(b){return b===Object(b)};aj.isArguments=function(b){return af.call(b)=="[object Arguments]"};if(!aj.isArguments(arguments)){aj.isArguments=function(b){return !(!b||!aj.has(b,"callee"))}}aj.isFunction=function(b){return af.call(b)=="[object Function]"};aj.isString=function(b){return af.call(b)=="[object String]"};aj.isNumber=function(b){return af.call(b)=="[object Number]"};aj.isNaN=function(b){return b!==b};aj.isBoolean=function(b){return b===true||b===false||af.call(b)=="[object Boolean]"};aj.isDate=function(b){return af.call(b)=="[object Date]"};aj.isRegExp=function(b){return af.call(b)=="[object RegExp]"};aj.isNull=function(b){return b===null};aj.isUndefined=function(b){return b===void 0};aj.has=function(j,i){return g.call(j,i)};aj.noConflict=function(){X._=P;return this};aj.identity=function(b){return b};aj.times=function(j,i,l){for(var k=0;k<j;k++){i.call(l,k)}};aj.escape=function(b){return(""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};aj.mixin=function(b){ah(aj.functions(b),function(i){c(i,aj[i]=b[i])})};var a=0;aj.uniqueId=function(j){var i=a++;return j?j+i:i};aj.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var S=/.^/,Q=function(b){return b.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};aj.template=function(b,k){var j=aj.templateSettings,j="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+b.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(j.escape||S,function(m,l){return"',_.escape("+Q(l)+"),'"}).replace(j.interpolate||S,function(m,l){return"',"+Q(l)+",'"}).replace(j.evaluate||S,function(m,l){return"');"+Q(l).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",i=new Function("obj","_",j);return k?i(k,aj):function(l){return i.call(this,l,aj)}};aj.chain=function(b){return aj(b).chain()};var ae=function(b){this._wrapped=b};aj.prototype=ae.prototype;var O=function(b,i){return i?aj(b).chain():b},c=function(b,i){ae.prototype[b]=function(){var j=ai.call(arguments);M.call(j,this._wrapped);return O(i.apply(aj,j),this._chain)}};aj.mixin(aj);ah("pop,push,reverse,shift,sort,splice,unshift".split(","),function(j){var i=ag[j];ae.prototype[j]=function(){var k=this._wrapped;i.apply(k,arguments);var b=k.length;(j=="shift"||j=="splice")&&b===0&&delete k[0];return O(k,this._chain)}});ah(["concat","join","slice"],function(j){var i=ag[j];ae.prototype[j]=function(){return O(i.apply(this._wrapped,arguments),this._chain)}});ae.prototype.chain=function(){this._chain=true;return this};ae.prototype.value=function(){return this._wrapped}}).call(this);(function(){var n=this;var l=n.Backbone;var m=Array.prototype.slice;var u=Array.prototype.splice;var b;if(typeof exports!=="undefined"){b=exports}else{b=n.Backbone={}}b.VERSION="0.9.1";var v=n._;if(!v&&(typeof require!=="undefined")){v=require("underscore")}var e=n.jQuery||n.Zepto||n.ender;b.setDomLibrary=function(w){e=w};b.noConflict=function(){n.Backbone=l;return this};b.emulateHTTP=false;b.emulateJSON=false;b.Events={on:function(A,D,z){var B;A=A.split(/\s+/);var y=this._callbacks||(this._callbacks={});while(B=A.shift()){var C=y[B]||(y[B]={});var w=C.tail||(C.tail=C.next={});w.callback=D;w.context=z;C.tail=w.next={}}return this},off:function(z,C,y){var B,w,A;if(!z){delete this._callbacks}else{if(w=this._callbacks){z=z.split(/\s+/);while(B=z.shift()){A=w[B];delete w[B];if(!C||!A){continue}while((A=A.next)&&A.next){if(A.callback===C&&(!y||A.context===y)){continue}this.on(B,A.callback,A.context)}}}}return this},trigger:function(A){var E,D,z,y,w,C,B;if(!(z=this._callbacks)){return this}C=z.all;(A=A.split(/\s+/)).push(null);while(E=A.shift()){if(C){A.push({next:C.next,tail:C.tail,event:E})}if(!(D=z[E])){continue}A.push({next:D.next,tail:D.tail})}B=m.call(arguments,1);while(D=A.pop()){y=D.tail;w=D.event?[D.event].concat(B):B;while((D=D.next)!==y){D.callback.apply(D.context||this,w)}}return this}};b.Events.bind=b.Events.on;b.Events.unbind=b.Events.off;b.Model=function(w,y){var z;w||(w={});if(y&&y.parse){w=this.parse(w)}if(z=c(this,"defaults")){w=v.extend({},z,w)}if(y&&y.collection){this.collection=y.collection}this.attributes={};this._escapedAttributes={};this.cid=v.uniqueId("c");if(!this.set(w,{silent:true})){throw new Error("Can't create an invalid model")}delete this._changed;this._previousAttributes=v.clone(this.attributes);this.initialize.apply(this,arguments)};v.extend(b.Model.prototype,b.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return v.clone(this.attributes)},get:function(w){return this.attributes[w]},escape:function(w){var y;if(y=this._escapedAttributes[w]){return y}var z=this.attributes[w];return this._escapedAttributes[w]=v.escape(z==null?"":""+z)},has:function(w){return this.attributes[w]!=null},set:function(E,D,G){var F,C,z;if(v.isObject(E)||E==null){F=E;G=D}else{F={};F[E]=D}G||(G={});if(!F){return this}if(F instanceof b.Model){F=F.attributes}if(G.unset){for(C in F){F[C]=void 0}}if(!this._validate(F,G)){return false}if(this.idAttribute in F){this.id=F[this.idAttribute]}var y=this.attributes;var w=this._escapedAttributes;var A=this._previousAttributes||{};var B=this._setting;this._changed||(this._changed={});this._setting=true;for(C in F){z=F[C];if(!v.isEqual(y[C],z)){delete w[C]}G.unset?delete y[C]:y[C]=z;if(this._changing&&!v.isEqual(this._changed[C],z)){this.trigger("change:"+C,this,z,G);this._moreChanges=true}delete this._changed[C];if(!v.isEqual(A[C],z)||(v.has(y,C)!=v.has(A,C))){this._changed[C]=z}}if(!B){if(!G.silent&&this.hasChanged()){this.change(G)}this._setting=false}return this},unset:function(w,y){(y||(y={})).unset=true;return this.set(w,null,y)},clear:function(w){(w||(w={})).unset=true;return this.set(v.clone(this.attributes),w)},fetch:function(y){y=y?v.clone(y):{};var w=this;var z=y.success;y.success=function(C,A,B){if(!w.set(w.parse(C,B),y)){return false}if(z){z(w,C)}};y.error=b.wrapError(y.error,w,y);return(this.sync||b.sync).call(this,"read",this,y)},save:function(C,B,G){var D,A;if(v.isObject(C)||C==null){D=C;G=B}else{D={};D[C]=B}G=G?v.clone(G):{};if(G.wait){A=v.clone(this.attributes)}var y=v.extend({},G,{silent:true});if(D&&!this.set(D,G.wait?y:G)){return false}var z=this;var E=G.success;G.success=function(K,H,J){var I=z.parse(K,J);if(G.wait){I=v.extend(D||{},I)}if(!z.set(I,G)){return false}if(E){E(z,K)}else{z.trigger("sync",z,K,G)}};G.error=b.wrapError(G.error,z,G);var w=this.isNew()?"create":"update";var F=(this.sync||b.sync).call(this,w,this,G);if(G.wait){this.set(A,y)}return F},destroy:function(y){y=y?v.clone(y):{};var w=this;var B=y.success;var A=function(){w.trigger("destroy",w,w.collection,y)};if(this.isNew()){return A()}y.success=function(C){if(y.wait){A()}if(B){B(w,C)}else{w.trigger("sync",w,C,y)}};y.error=b.wrapError(y.error,w,y);var z=(this.sync||b.sync).call(this,"delete",this,y);if(!y.wait){A()}return z},url:function(){var w=c(this.collection,"url")||c(this,"urlRoot")||p();if(this.isNew()){return w}return w+(w.charAt(w.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(y,w){return y},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(y){if(this._changing||!this.hasChanged()){return this}this._changing=true;this._moreChanges=true;for(var w in this._changed){this.trigger("change:"+w,this,this._changed[w],y)}while(this._moreChanges){this._moreChanges=false;this.trigger("change",this,y)}this._previousAttributes=v.clone(this.attributes);delete this._changed;this._changing=false;return this},hasChanged:function(w){if(!arguments.length){return !v.isEmpty(this._changed)}return this._changed&&v.has(this._changed,w)},changedAttributes:function(z){if(!z){return this.hasChanged()?v.clone(this._changed):false}var B,A=false,y=this._previousAttributes;for(var w in z){if(v.isEqual(y[w],(B=z[w]))){continue}(A||(A={}))[w]=B}return A},previous:function(w){if(!arguments.length||!this._previousAttributes){return null}return this._previousAttributes[w]},previousAttributes:function(){return v.clone(this._previousAttributes)},isValid:function(){return !this.validate(this.attributes)},_validate:function(z,y){if(y.silent||!this.validate){return true}z=v.extend({},this.attributes,z);var w=this.validate(z,y);if(!w){return true}if(y&&y.error){y.error(this,w,y)}else{this.trigger("error",this,w,y)}return false}});b.Collection=function(y,w){w||(w={});if(w.comparator){this.comparator=w.comparator}this._reset();this.initialize.apply(this,arguments);if(y){this.reset(y,{silent:true,parse:w.parse})}};v.extend(b.Collection.prototype,b.Events,{model:b.Model,initialize:function(){},toJSON:function(){return this.map(function(w){return w.toJSON()})},add:function(y,G){var C,E,A,D,F,z,B={},w={};G||(G={});y=v.isArray(y)?y.slice():[y];for(C=0,A=y.length;C<A;C++){if(!(D=y[C]=this._prepareModel(y[C],G))){throw new Error("Can't add an invalid model to a collection")}if(B[F=D.cid]||this._byCid[F]||(((z=D.id)!=null)&&(w[z]||this._byId[z]))){throw new Error("Can't add the same model to a collection twice")}B[F]=w[z]=D}for(C=0;C<A;C++){(D=y[C]).on("all",this._onModelEvent,this);this._byCid[D.cid]=D;if(D.id!=null){this._byId[D.id]=D}}this.length+=A;E=G.at!=null?G.at:this.models.length;u.apply(this.models,[E,0].concat(y));if(this.comparator){this.sort({silent:true})}if(G.silent){return this}for(C=0,A=this.models.length;C<A;C++){if(!B[(D=this.models[C]).cid]){continue}G.index=C;D.trigger("add",D,this,G)}return this},remove:function(C,A){var B,w,z,y;A||(A={});C=v.isArray(C)?C.slice():[C];for(B=0,w=C.length;B<w;B++){y=this.getByCid(C[B])||this.get(C[B]);if(!y){continue}delete this._byId[y.id];delete this._byCid[y.cid];z=this.indexOf(y);this.models.splice(z,1);this.length--;if(!A.silent){A.index=z;y.trigger("remove",y,this,A)}this._removeReference(y)}return this},get:function(w){if(w==null){return null}return this._byId[w.id!=null?w.id:w]},getByCid:function(w){return w&&this._byCid[w.cid||w]},at:function(w){return this.models[w]},sort:function(y){y||(y={});if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}var w=v.bind(this.comparator,this);if(this.comparator.length==1){this.models=this.sortBy(w)}else{this.models.sort(w)}if(!y.silent){this.trigger("reset",this,y)}return this},pluck:function(w){return v.map(this.models,function(y){return y.get(w)})},reset:function(A,y){A||(A=[]);y||(y={});for(var z=0,w=this.models.length;z<w;z++){this._removeReference(this.models[z])}this._reset();this.add(A,{silent:true,parse:y.parse});if(!y.silent){this.trigger("reset",this,y)}return this},fetch:function(w){w=w?v.clone(w):{};if(w.parse===undefined){w.parse=true}var z=this;var y=w.success;w.success=function(C,A,B){z[w.add?"add":"reset"](z.parse(C,B),w);if(y){y(z,C)}};w.error=b.wrapError(w.error,z,w);return(this.sync||b.sync).call(this,"read",this,w)},create:function(y,w){var z=this;w=w?v.clone(w):{};y=this._prepareModel(y,w);if(!y){return false}if(!w.wait){z.add(y,w)}var A=w.success;w.success=function(B,D,C){if(w.wait){z.add(B,w)}if(A){A(B,D)}else{B.trigger("sync",y,D,w)}};y.save(null,w);return y},parse:function(y,w){return y},chain:function(){return v(this.models).chain()},_reset:function(w){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(z,y){if(!(z instanceof b.Model)){var w=z;y.collection=this;z=new this.model(w,y);if(!z._validate(z.attributes,y)){z=false}}else{if(!z.collection){z.collection=this}}return z},_removeReference:function(w){if(this==w.collection){delete w.collection}w.off("all",this._onModelEvent,this)},_onModelEvent:function(z,y,A,w){if((z=="add"||z=="remove")&&A!=this){return}if(z=="destroy"){this.remove(y,w)}if(y&&z==="change:"+y.idAttribute){delete this._byId[y.previous(y.idAttribute)];this._byId[y.id]=y}this.trigger.apply(this,arguments)}});var s=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];v.each(s,function(w){b.Collection.prototype[w]=function(){return v[w].apply(v,[this.models].concat(v.toArray(arguments)))}});b.Router=function(w){w||(w={});if(w.routes){this.routes=w.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var g=/:\w+/g;var t=/\*\w+/g;var d=/[-[\]{}()+?.,\\^$|#\s]/g;v.extend(b.Router.prototype,b.Events,{initialize:function(){},route:function(w,y,z){b.history||(b.history=new b.History);if(!v.isRegExp(w)){w=this._routeToRegExp(w)}if(!z){z=this[y]}b.history.route(w,v.bind(function(B){var A=this._extractParameters(w,B);z&&z.apply(this,A);this.trigger.apply(this,["route:"+y].concat(A));b.history.trigger("route",this,y,A)},this));return this},navigate:function(y,w){b.history.navigate(y,w)},_bindRoutes:function(){if(!this.routes){return}var y=[];for(var z in this.routes){y.unshift([z,this.routes[z]])}for(var A=0,w=y.length;A<w;A++){this.route(y[A][0],y[A][1],this[y[A][1]])}},_routeToRegExp:function(w){w=w.replace(d,"\\$&").replace(g,"([^/]+)").replace(t,"(.*?)");return new RegExp("^"+w+"$")},_extractParameters:function(w,y){return w.exec(y).slice(1)}});b.History=function(){this.handlers=[];v.bindAll(this,"checkUrl")};var k=/^[#\/]/;var h=/msie [\w.]+/;var j=false;v.extend(b.History.prototype,b.Events,{interval:50,getFragment:function(y,w){if(y==null){if(this._hasPushState||w){y=window.location.pathname;var z=window.location.search;if(z){y+=z}}else{y=window.location.hash}}y=decodeURIComponent(y);if(!y.indexOf(this.options.root)){y=y.substr(this.options.root.length)}return y.replace(k,"")},start:function(z){if(j){throw new Error("Backbone.history has already been started")}this.options=v.extend({},{root:"/"},this.options,z);this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var y=this.getFragment();var w=document.documentMode;var B=(h.exec(navigator.userAgent.toLowerCase())&&(!w||w<=7));if(B){this.iframe=e('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(y)}if(this._hasPushState){e(window).bind("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!B){e(window).bind("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=y;j=true;var C=window.location;var A=C.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!A){this.fragment=this.getFragment(null,true);window.location.replace(this.options.root+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&A&&C.hash){this.fragment=C.hash.replace(k,"");window.history.replaceState({},document.title,C.protocol+"//"+C.host+this.options.root+this.fragment)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){e(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);j=false},route:function(w,y){this.handlers.unshift({route:w,callback:y})},checkUrl:function(y){var w=this.getFragment();if(w==this.fragment&&this.iframe){w=this.getFragment(this.iframe.location.hash)}if(w==this.fragment||w==decodeURIComponent(this.fragment)){return false}if(this.iframe){this.navigate(w)}this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(z){var y=this.fragment=this.getFragment(z);var w=v.any(this.handlers,function(A){if(A.route.test(y)){A.callback(y);return true}});return w},navigate:function(y,w){if(!j){return false}if(!w||w===true){w={trigger:w}}var z=(y||"").replace(k,"");if(this.fragment==z||this.fragment==decodeURIComponent(z)){return}if(this._hasPushState){if(z.indexOf(this.options.root)!=0){z=this.options.root+z}this.fragment=z;window.history[w.replace?"replaceState":"pushState"]({},document.title,z)}else{if(this._wantsHashChange){this.fragment=z;this._updateHash(window.location,z,w.replace);if(this.iframe&&(z!=this.getFragment(this.iframe.location.hash))){if(!w.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,z,w.replace)}}else{window.location.assign(this.options.root+y)}}if(w.trigger){this.loadUrl(y)}},_updateHash:function(w,y,z){if(z){w.replace(w.toString().replace(/(javascript:|#).*$/,"")+"#"+y)}else{w.hash=y}}});b.View=function(w){this.cid=v.uniqueId("view");this._configure(w||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var a=/^(\S+)\s*(.*)$/;var q=["model","collection","el","id","attributes","className","tagName"];v.extend(b.View.prototype,b.Events,{tagName:"div",$:function(w){return this.$el.find(w)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(y,w,A){var z=document.createElement(y);if(w){e(z).attr(w)}if(A){e(z).html(A)}return z},setElement:function(w,y){this.$el=e(w);this.el=this.$el[0];if(y!==false){this.delegateEvents()}return this},delegateEvents:function(B){if(!(B||(B=c(this,"events")))){return}this.undelegateEvents();for(var A in B){var C=B[A];if(!v.isFunction(C)){C=this[B[A]]}if(!C){throw new Error('Event "'+B[A]+'" does not exist')}var z=A.match(a);var y=z[1],w=z[2];C=v.bind(C,this);y+=".delegateEvents"+this.cid;if(w===""){this.$el.bind(y,C)}else{this.$el.delegate(w,y,C)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(z){if(this.options){z=v.extend({},this.options,z)}for(var A=0,y=q.length;A<y;A++){var w=q[A];if(z[w]){this[w]=z[w]}}this.options=z},_ensureElement:function(){if(!this.el){var w=c(this,"attributes")||{};if(this.id){w.id=this.id}if(this.className){w["class"]=this.className}this.setElement(this.make(this.tagName,w),false)}else{this.setElement(this.el,false)}}});var r=function(w,y){var z=i(this,w,y);z.extend=this.extend;return z};b.Model.extend=b.Collection.extend=b.Router.extend=b.View.extend=r;var o={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};b.sync=function(B,y,w){var z=o[B];var A={type:z,dataType:"json"};if(!w.url){A.url=c(y,"url")||p()}if(!w.data&&y&&(B=="create"||B=="update")){A.contentType="application/json";A.data=JSON.stringify(y.toJSON())}if(b.emulateJSON){A.contentType="application/x-www-form-urlencoded";A.data=A.data?{model:A.data}:{}}if(b.emulateHTTP){if(z==="PUT"||z==="DELETE"){if(b.emulateJSON){A.data._method=z}A.type="POST";A.beforeSend=function(C){C.setRequestHeader("X-HTTP-Method-Override",z)}}}if(A.type!=="GET"&&!b.emulateJSON){A.processData=false}return e.ajax(v.extend(A,w))};b.wrapError=function(y,z,w){return function(A,B){B=A===z?B:A;if(y){y(z,B,w)}else{z.trigger("error",z,B,w)}}};var f=function(){};var i=function(y,w,z){var A;if(w&&w.hasOwnProperty("constructor")){A=w.constructor}else{A=function(){y.apply(this,arguments)}}v.extend(A,y);f.prototype=y.prototype;A.prototype=new f();if(w){v.extend(A.prototype,w)}if(z){v.extend(A,z)}A.prototype.constructor=A;A.__super__=y.prototype;return A};var c=function(w,y){if(!(w&&w[y])){return null}return v.isFunction(w[y])?w[y]():w[y]};var p=function(){throw new Error('A "url" property or function must be specified')}}).call(this);window.google=window.google||{};google.maps=google.maps||{};(function(){function a(d){document.write('<script src="'+d+'" type="text/javascript"><\/script>')}var b=google.maps.modules={};google.maps.__gjsload__=function(d,e){b[d]=e};google.maps.Load=function(d){delete google.maps.Load;d([null,[[["http://mt0.googleapis.com/vt?lyrs=m@186000000\u0026src=api\u0026hl=ru\u0026","http://mt1.googleapis.com/vt?lyrs=m@186000000\u0026src=api\u0026hl=ru\u0026"],null,null,null,null,"m@186000000"],[["http://khm0.googleapis.com/kh?v=117\u0026hl=ru\u0026","http://khm1.googleapis.com/kh?v=117\u0026hl=ru\u0026"],null,null,null,1,"117"],[["http://mt0.googleapis.com/vt?lyrs=h@186000000\u0026src=api\u0026hl=ru\u0026","http://mt1.googleapis.com/vt?lyrs=h@186000000\u0026src=api\u0026hl=ru\u0026"],null,null,"imgtp=png32\u0026",null,"h@186000000"],[["http://mt0.googleapis.com/vt?lyrs=t@129,r@186000000\u0026src=api\u0026hl=ru\u0026","http://mt1.googleapis.com/vt?lyrs=t@129,r@186000000\u0026src=api\u0026hl=ru\u0026"],null,null,null,null,"t@129,r@186000000"],null,[[null,0,7,7,[[[330000000,1246050000],[386200000,1293600000]],[[366500000,1297000000],[386200000,1314843700]]],["http://mt0.gmaptiles.co.kr/mt?v=kr1.17\u0026hl=ru\u0026","http://mt1.gmaptiles.co.kr/mt?v=kr1.17\u0026hl=ru\u0026"]],[null,0,8,8,[[[330000000,1246050000],[386200000,1279600000]],[[345000000,1279600000],[386200000,1286700000]],[[354690000,1286700000],[386200000,1314843700]]],["http://mt0.gmaptiles.co.kr/mt?v=kr1.17\u0026hl=ru\u0026","http://mt1.gmaptiles.co.kr/mt?v=kr1.17\u0026hl=ru\u0026"]],[null,0,9,9,[[[330000000,1246050000],[386200000,1279600000]],[[340000000,1279600000],[386200000,1286700000]],[[348900000,1286700000],[386200000,1302000000]],[[368300000,1302000000],[386200000,1314843700]]],["http://mt0.gmaptiles.co.kr/mt?v=kr1.17\u0026hl=ru\u0026","http://mt1.gmaptiles.co.kr/mt?v=kr1.17\u0026hl=ru\u0026"]],[null,0,10,19,[[[329890840,1246055600],[386930130,1284960940]],[[344646740,1284960940],[386930130,1288476560]],[[350277470,1288476560],[386930130,1310531620]],[[370277730,1310531620],[386930130,1314843700]]],["http://mt0.gmaptiles.co.kr/mt?v=kr1.17\u0026hl=ru\u0026","http://mt1.gmaptiles.co.kr/mt?v=kr1.17\u0026hl=ru\u0026"]],[null,3,7,7,[[[330000000,1246050000],[386200000,1293600000]],[[366500000,1297000000],[386200000,1314843700]]],["http://mt0.gmaptiles.co.kr/mt?v=kr1p.17\u0026hl=ru\u0026","http://mt1.gmaptiles.co.kr/mt?v=kr1p.17\u0026hl=ru\u0026"]],[null,3,8,8,[[[330000000,1246050000],[386200000,1279600000]],[[345000000,1279600000],[386200000,1286700000]],[[354690000,1286700000],[386200000,1314843700]]],["http://mt0.gmaptiles.co.kr/mt?v=kr1p.17\u0026hl=ru\u0026","http://mt1.gmaptiles.co.kr/mt?v=kr1p.17\u0026hl=ru\u0026"]],[null,3,9,9,[[[330000000,1246050000],[386200000,1279600000]],[[340000000,1279600000],[386200000,1286700000]],[[348900000,1286700000],[386200000,1302000000]],[[368300000,1302000000],[386200000,1314843700]]],["http://mt0.gmaptiles.co.kr/mt?v=kr1p.17\u0026hl=ru\u0026","http://mt1.gmaptiles.co.kr/mt?v=kr1p.17\u0026hl=ru\u0026"]],[null,3,10,null,[[[329890840,1246055600],[386930130,1284960940]],[[344646740,1284960940],[386930130,1288476560]],[[350277470,1288476560],[386930130,1310531620]],[[370277730,1310531620],[386930130,1314843700]]],["http://mt0.gmaptiles.co.kr/mt?v=kr1p.17\u0026hl=ru\u0026","http://mt1.gmaptiles.co.kr/mt?v=kr1p.17\u0026hl=ru\u0026"]]],[["http://cbk0.googleapis.com/cbk?","http://cbk1.googleapis.com/cbk?"]],[["http://khm0.googleapis.com/kh?v=62\u0026hl=ru\u0026","http://khm1.googleapis.com/kh?v=62\u0026hl=ru\u0026"],null,null,null,null,"62"],[["http://mt0.googleapis.com/mapslt?hl=ru\u0026","http://mt1.googleapis.com/mapslt?hl=ru\u0026"]],[["http://mt0.googleapis.com/mapslt/ft?hl=ru\u0026","http://mt1.googleapis.com/mapslt/ft?hl=ru\u0026"]],[["http://mt0.googleapis.com/vt?hl=ru\u0026","http://mt1.googleapis.com/vt?hl=ru\u0026"]]],["ru","US",null,0,null,null,"http://maps.gstatic.com/mapfiles/","http://csi.gstatic.com","https://maps.googleapis.com","http://maps.googleapis.com"],["http://maps.gstatic.com/intl/ru_ALL/mapfiles/api-3/9/14","3.9.14"],[351462400],1,null,null,null,null,0,"",["geometry"],null,0,"http://khm.googleapis.com/mz?v=117\u0026",null,"https://earthbuilder.google.com","https://earthbuilder.googleapis.com"],c)};var c=(new Date).getTime();a("http://maps.gstatic.com/cat_js/intl/ru_ALL/mapfiles/api-3/9/14/%7Bmain,geometry%7D.js")})();if((typeof App)==="undefined"){App={}}App.Views={};App.Models={};$(function(){App.Views.Map=Backbone.View.extend({initialize:function(){_.bindAll(this,"LoadMapPosition","SaveMapPosition","LoadMapZoom","SaveMapZoom","LoadMapType","SaveMapType","getMap")},render:function(){var a={zoom:16,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDoubleClickZoom:true,draggableCursor:"default",center:new google.maps.LatLng(42.8753903660182,74.63396263701634)};this.map=new google.maps.Map(this.$el[0],a);this.LoadMapPosition();this.LoadMapZoom();this.LoadMapType();google.maps.event.addListener(this.map,"dragend",this.SaveMapPosition);google.maps.event.addListener(this.map,"zoom_changed",this.SaveMapZoom);google.maps.event.addListener(this.map,"maptypeid_changed",this.SaveMapType);google.maps.event.addListenerOnce(this.map,"idle",$.proxy(function(){this.trigger("rendered")},this));return this},LoadMapPosition:function(){var a=$.jCookies({get:"map_position"});if(a){this.map.setCenter(new google.maps.LatLng(a.lat,a.lng))}},SaveMapPosition:function(){$.jCookies({name:"map_position",value:{lat:this.map.getCenter().lat(),lng:this.map.getCenter().lng()}})},SaveMapZoom:function(){$.jCookies({name:"map_zoom",value:this.map.getZoom()})},LoadMapZoom:function(){var a=$.jCookies({get:"map_zoom"});if(a){this.map.setZoom(a)}},SaveMapType:function(){$.jCookies({name:"map_type",value:this.map.getMapTypeId()})},LoadMapType:function(){var a=$.jCookies({get:"map_type"});if(a){this.map.setMapTypeId(a)}},getMap:function(){return this.map}})});App.Views.BsDirection=Backbone.View.extend({arrows:[],initialize:function(){_.bindAll(this,"render","deleteArrow","disable");this.el=this.options.map.getDiv();$(this.el).click(this.render)},render:function(a){this.model=new App.Models.NearestBaseStations;this.model.on("success",function(b){this.deleteArrow();_.each(b.get("locations"),function(c){this.arrows.push(this.getArrow(this.getLatLngFromEvent(a),c))},this)},this);this.model.fetch({data:{lat:this.getLatLngFromEvent(a).lat(),lng:this.getLatLngFromEvent(a).lng()},success:function(b){b.trigger("success",b)}})},getLatLngFromEvent:function(b){var a;a=new google.maps.Point(parseInt(b.pageX),parseInt(b.pageY));return App.Views.overlay.get().getProjection().fromContainerPixelToLatLng(a)},getArrow:function(g,f){var b=Math.sqrt(Math.pow(f.lat-g.lat(),2)+Math.pow(f.lng-g.lng(),2));var e={lat:(f.lat-g.lat()),lng:(f.lng-g.lng())};var a={lat:((e.lat/b)*0.006)+g.lat(),lng:((e.lng/b)*0.006)+g.lng()};var c=new google.maps.LatLng(a.lat,a.lng);var d=new google.maps.Polyline({path:[g,c],strokeColor:"red",strokeOpacity:1,strokeWeight:2,map:this.options.map});return d},deleteArrow:function(){_.each(this.arrows,function(a){a.setMap(null)});this.arrows=[]},disable:function(){$(this.el).unbind("click",this.render);this.deleteArrow()}});$(function(){App.Models.NearestBaseStations=Backbone.Model.extend({sync:function(c,b,a){switch(c){case"get":return Backbone.sync(c,b,{dataType:"json",data:a.data,success:$.proxy(function(d){b.set(d)},this)});break;default:return Backbone.sync(c,b,a);break}},silent:true,url:"/bs_direction"})});$(document).ready(function(){App.Views.map=new App.Views.Map({el:"#map_canvas"}).render();App.Views.overlay=new (Backbone.View.extend({initialize:function(){_.bindAll(this,"get");this.overlay=new google.maps.OverlayView();this.overlay.draw=function(){};this.overlay.setMap(App.Views.map.getMap())},get:function(){return this.overlay}}));new App.Views.BsDirection({map:App.Views.map.getMap()})});